# Лекция №5. Основы JavaScript: синтаксис и работа с DOM

---

## 1. Введение в JavaScript

### 1.1. Что такое JavaScript

> **JavaScript** — это интерпретируемый, динамически типизированный, мультипарадигменный язык программирования, который изначально был создан для взаимодействия с веб-страницами в браузере.

**Немного подробнее:**

- **Интерпретируемый** — не компилируется заранее, а выполняется построчно прямо в браузере.
- **Динамически типизированный** — переменные могут менять тип на лету, типы данных определяются во время выполнения.
- **Мультипарадигменный** — поддерживает императивный, функциональный и объектно-ориентированный стили программирования.
- **Высокоуровневый** — абстрагирует работу с памятью, ближе к человеку, чем к машине.

**Немного истории:**

- Создан в 1995 году Брэнданом Айком (Brendan Eich) за 10 дней.
- Изначально назывался LiveScript, но был переименован в JavaScript из маркетинговых соображений.
- С тех пор вырос из простого скриптового языка до мощной платформы, на которой можно писать веб-приложения, серверы, игры.

**Сейчас JavaScript:**

- Работает во всех браузерах
- Используется как на клиенте, так и на сервере (Node.js)
- Является основой таких фреймворков, как React, Vue, Angular, Svelte

---

### 1.2. JS в веб-разработке

Если HTML задаёт структуру, а CSS — внешний вид, то JavaScript отвечает за поведение. Он позволяет странице реагировать на действия пользователя и изменяться без перезагрузки.

**Основные задачи JavaScript на веб-странице:**

1. **Работа с DOM (структурой HTML-документа):**
- Изменение текста, атрибутов и классов HTML-элементов.
- Показ или скрытие элементов.
- Динамическое добавление и удаление блоков.

2. **Обработка действий пользователя:**
- Реакция на клики, ввод с клавиатуры, наведение, прокрутку и другие события.
- Проверка корректности введённых данных в формах до их отправки.
- Отображение интерактивных подсказок и всплывающих окон.

3. **Обмен данными с сервером без перезагрузки страницы:**
- Отправка и получение данных через AJAX и Fetch API.
- Реализация динамической подгрузки контента (например, в лентах новостей или в бесконечном скролле).

4. **Анимации и визуальные эффекты:**
- Плавное появление, исчезновение и перемещение элементов.
- Создание слайдеров, галерей, выпадающих меню и табов.

5. **Построение интерактивных компонентов:**
- Реализация выпадающих списков, бургер-меню, вкладок, модальных окон и других UI-элементов.
- Создание фильтров, калькуляторов, онлайн-форм и всего, что требует динамики.

---

### 1.3. Где работает JavaScript

JavaScript был создан как язык для браузера, но сегодня его возможности гораздо шире. Он может выполняться в разных средах, как на клиенте, так и на сервере.

**Где используется JavaScript:**

1. **В браузере (на клиенте):**
- Это основное место выполнения JavaScript.
- Код встраивается в HTML через тег `<script>`.
- Выполняется интерпретатором браузера (Chrome, Firefox, Safari и т. д.).
- Позволяет работать с DOM, реагировать на действия пользователя, управлять стилями, отправлять запросы и т. д.

2. **На сервере (с помощью Node.js):**
- Node.js — это среда выполнения JavaScript вне браузера.
- Используется для создания серверов, API, бэкенд-логики.
- Позволяет работать с файлами, базами данных, сетью и т. д.

3. **В гибридных и настольных приложениях:**
- С помощью Electron можно создавать кроссплатформенные приложения (например, Visual Studio Code написан на JavaScript).
- JavaScript может использоваться в мобильной разработке (React Native) и в системах с встраиваемыми интерфейсами.

4. **В инструментах и автоматизации:**
- JavaScript применяется для написания сборщиков (Webpack, Vite), CLI-утилит, скриптов для тестирования и автоматизации задач.

**Пример:**

Если открыть DevTools в любом браузере и ввести в консоль:

```javascript
document.body.style.background = 'lightyellow';
```

---

## 2. Базовый синтаксис и типы данных

### 2.1. Переменные let, const, var

В JavaScript переменные — это именованные контейнеры для хранения данных. Их можно объявить с помощью ключевых слов `let`, `const` или `var`.

> **Переменные** — это именованные контейнеры для хранения данных, которые можно использовать и изменять в программе.

**Способы объявления:**

- **`let`** — переменная, значение которой можно переопределить

```javascript
let count = 1;
count = 2;
```

- **`const`** — переменная с постоянной ссылкой. Нельзя переприсвоить новое значение, но если переменная содержит объект или массив — их внутреннее содержимое можно менять.

```javascript
const site = 'example.com';
// site = 'new.com'; // Ошибка — нельзя переприсвоить

const user = { name: 'Иван' };
user.name = 'Ольга'; // Допустимо — объект не заморожен
```

- **`var`** — устаревший способ объявления переменных. Имеет функциональную область видимости и подвержен всплытию (hoisting). Не рекомендуется к использованию в современном коде.

**Правила именования переменных:**

- Имя должно начинаться с буквы, символа подчеркивания «_» или знака доллара «$».
- Нельзя использовать пробелы, тире и специальные символы.
- JavaScript чувствителен к регистру: `userName` и `username` — разные переменные.

Принято использовать стиль **camelCase**: `userAge`, `totalSum`, `isActive`.

**Примеры:**

```javascript
let city = 'Москва';
const person = { name: 'Аня' };

person.name = 'Юля';      // допустимо
// person = { name: 'Олег' }; // ошибка: нельзя переприсвоить const
```

**Рекомендация:**

- Используй `const` по умолчанию, если значение не должно переопределяться.
- Применяй `let`, если переменная будет изменяться.
- Не используй `var` в современном коде, кроме как для изучения особенностей языка.

---

### 2.2. Типы данных

JavaScript — язык с динамической типизацией. Это значит, что переменная может содержать значение любого типа, и тип может изменяться во время выполнения программы.

> **Типы данных** — это классификация данных, которая определяет возможные значения и операции над ними.

**Основные типы данных:**

1. **Примитивные типы:**

- **Number** — числа (целые и с плавающей точкой).

```javascript
let age = 25;
let temperature = -10.5;
```

- **String** — строки (текст).

```javascript
let name = 'Алексей';
let greeting = "Привет";
```

- **Boolean** — логический тип (`true` или `false`).

```javascript
let isActive = true;
let isLoggedIn = false;
```

- **Undefined** — значение переменной не определено.

```javascript
let data;
console.log(data); // undefined
```

- **Null** — "отсутствие значения", специальное значение.

```javascript
let user = null;
```

- **Symbol** — уникальный идентификатор (используется редко).

```javascript
let id = Symbol('id');
```

- **BigInt** — большие целые числа, выходящие за пределы Number.

```javascript
let bigNumber = 9007199254740991n;
```

2. **Ссылочные типы:**

- **Object** — объект, коллекция пар «ключ-значение».

```javascript
let person = {
 name: 'Иван',
 age: 30,
 isMarried: true
};
```

- **Array** — упорядоченный набор значений (особый вид объектов).

```javascript
let colors = ['красный', 'зелёный', 'синий'];
console.log(colors[0]); // 'красный'
```

- **Function** — функции тоже объекты, которые можно вызвать.

```javascript
function greet(name) {
 return 'Привет, ' + name + '!';
}

console.log(greet('Маша')); // 'Привет, Маша!'
```

**Проверка типа данных:**

Для проверки типа данных используется оператор `typeof`:

```javascript
console.log(typeof 42);           // 'number'
console.log(typeof 'hello');      // 'string'
console.log(typeof true);         // 'boolean'
console.log(typeof undefined);    // 'undefined'
console.log(typeof null);         // 'object' (особенность языка)
console.log(typeof {});           // 'object'
console.log(typeof []);           // 'object'
console.log(typeof function(){}); // 'function'
```

> **Важно:** `typeof null` возвращает `'object'` — это историческое поведение JavaScript, о котором нужно помнить.

**Примеры использования различных типов:**

```javascript
let count = 10;               // Number
let message = 'Привет!';      // String
let isOpen = false;           // Boolean
let userData;                 // Undefined
let user = null;              // Null
let uniqueId = Symbol('id');  // Symbol
let bigNum = 123456789012345678901234567890n; // BigInt

let person = {                // Object
  name: 'Анна',
  age: 28
};

let fruits = ['яблоко', 'банан', 'вишня'];  // Array

function sayHi() {            // Function
  console.log('Привет!');
}
```

### 2.3. Операторы

Операторы — это специальные символы или слова, которые выполняют операции над значениями (операндами). В JavaScript много видов операторов: арифметические, присваивания, сравнения, логические и другие.

> **Операторы** — это символы или ключевые слова, которые выполняют операции над значениями и возвращают результат.

1. Арифметические операторы

Используются для выполнения математических операций.

**Таблица 1 – Арифметические операторы**

| Оператор | Описание | Пример | Результат |
|----------|-----------|---------|------------|
| `+` | Сложение | `5 + 3` | 8 |
| `-` | Вычитание | `5 - 3` | 2 |
| `*` | Умножение | `5 * 3` | 15 |
| `/` | Деление | `10 / 2` | 5 |
| `%` | Остаток от деления | `7 % 3` | 1 |
| `**` | Возведение в степень | `2 ** 3` | 8 |

**Пример:**

```javascript
let a = 10;
let b = 3;

console.log(a + b);  // 13
console.log(a - b);  // 7
console.log(a * b);  // 30
console.log(a / b);  // 3.3333...
console.log(a % b);  // 1
console.log(a ** b); // 1000
```

2. Операторы присваивания

Присваивают значение переменной, можно комбинировать с арифметикой.

**Таблица 2 – Операторы присваивания**

| Оператор | Описание | Пример | Результат переменной x |
|----------|-----------|---------|------------------------|
| `=` | Присваивание | `x = 5` | 5 |
| `+=` | Сложение и присваивание | `x += 3` | `x = x + 3` |
| `-=` | Вычитание и присваивание | `x -= 2` | `x = x - 2` |
| `*=` | Умножение и присваивание | `x *= 4` | `x = x * 4` |
| `/=` | Деление и присваивание | `x /= 2` | `x = x / 2` |
| `%=` | Остаток и присваивание | `x %= 3` | `x = x % 3` |

**Пример:**

```javascript
let x = 10;

x += 5; // x = 15
x *= 2; // x = 30
x -= 10; // x = 20

console.log(x); // 20
```

3. Операторы сравнения

Возвращают логическое значение `true` или `false` в зависимости от сравнения.

**Таблица 3 – Операторы сравнения**

| Оператор | Описание | Пример | Результат |
|----------|-----------|---------|------------|
| `==` | Равенство по значению | `5 == '5'` | `true` |
| `===` | Строгое равенство (по типу и значению) | `5 === '5'` | `false` |
| `!=` | Не равно по значению | `5 != 10` | `true` |
| `!==` | Строгое неравенство | `5 !== '5'` | `true` |
| `>` | Больше | `10 > 5` | `true` |
| `<` | Меньше | `5 < 10` | `true` |
| `>=` | Больше или равно | `5 >= 5` | `true` |
| `<=` | Меньше или равно | `3 <= 4` | `true` |

**Пример:**

```javascript
console.log(5 == '5');   // true (приведение типов)
console.log(5 === '5');  // false (разные типы)
console.log(10 > 7);     // true
console.log(3 <= 3);     // true
```

4. Логические операторы

Используются для логических операций над булевыми значениями.

**Таблица 4 – Логические операторы**

| Оператор | Описание | Пример | Результат |
|----------|-----------|---------|------------|
| `&&` | Логическое И | `true && false` | `false` |
| `\|\|` | Логическое ИЛИ | `true \|\| false` | `true` |
| `!` | Логическое НЕ | `!true` | `false` |

**Пример:**

```javascript
let isAdult = true;
let hasTicket = false;

console.log(isAdult && hasTicket); // false
console.log(isAdult || hasTicket); // true
console.log(!isAdult);              // false
```

5. Инкремент и декремент

Увеличение или уменьшение числа на 1.

**Таблица 5 – Инкремент и декремент**

| Оператор | Описание | Пример |
|----------|-----------|---------|
| `++` | Инкремент (увеличение на 1) | `x++` или `++x` |
| `--` | Декремент (уменьшение на 1) | `x--` или `--x` |

**Пример:**

```javascript
let i = 5;
console.log(i++); // 5 (сначала вывод, потом увеличение)
console.log(i);   // 6

let j = 5;
console.log(++j); // 6 (сначала увеличение, потом вывод)
console.log(j);   // 6
```

---

## 3. Управляющие конструкции

В программировании управляющие конструкции — это инструменты для изменения порядка выполнения кода в зависимости от условий или повторения действий. Они позволяют создавать логику, принимать решения и выполнять циклы.

> **Управляющие конструкции** — это языковые конструкции, которые позволяют управлять потоком выполнения программы на основе условий и циклов.

---

### 3.1. Условия: if, else, else if, тернарный оператор

1. **`if`** — базовая конструкция для проверки условия. Если условие истинно, выполняется блок кода.
2. **`else`** — задаёт альтернативный блок, если условие в `if` ложно.
3. **`else if`** — проверяет дополнительное условие, если предыдущее было ложным.
4. **Тернарный оператор** — компактный способ записи условного выражения.

**Примеры:**

```javascript
let age = 18;

if (age >= 18) {
  console.log('Взрослый');
} else {
  console.log('Несовершеннолетний');
}

// else if
let score = 75;
if (score >= 90) {
  console.log('Отлично');
} else if (score >= 60) {
  console.log('Хорошо');
} else {
  console.log('Попробуй ещё');
}

// Тернарный оператор
let access = (age >= 18) ? 'Доступ разрешён' : 'Доступ запрещён';
console.log(access);
```

### 3.2. Циклы: for, while, do...while

Циклы позволяют выполнять один и тот же блок кода несколько раз, пока выполняется заданное условие.

> **Циклы** — это управляющие конструкции, которые позволяют повторять выполнение блока кода до тех пор, пока выполняется заданное условие.

- **`for`** — самый распространённый цикл, обычно используется, когда заранее известно количество повторений.
- **`while`** — выполняет код, пока условие истинно; сначала проверяет условие, потом выполняет тело.
- **`do...while`** — сначала выполняет тело цикла, а потом проверяет условие; гарантирует выполнение хотя бы один раз.

**Примеры:**

```javascript
// for: вывести числа от 1 до 5
for (let i = 1; i <= 5; i++) {
  console.log(i);
}

// while: вывести числа от 1 до 5
let j = 1;
while (j <= 5) {
  console.log(j);
  j++;
}

// do...while: вывести числа от 1 до 5
let k = 1;
do {
  console.log(k);
  k++;
} while (k <= 5);
```

---

### 3.3. Примеры: подсчёты, проверка условий

Ниже — типичные практические задачи, которые часто решаются с помощью условий и циклов.

> **Практические задачи** — это реальные сценарии использования условий и циклов для решения распространённых проблем программирования.

- **Подсчёт чётных чисел в массиве:**

```javascript
let numbers = [1, 2, 3, 4, 5, 6];
let evenCount = 0;

for (let i = 0; i < numbers.length; i++) {
  if (numbers[i] % 2 === 0) {
    evenCount++;
  }
}

console.log('Количество чётных чисел:', evenCount);
```

- **Проверка возраста и вывода результата:**

```javascript
let age = 20;

if (age < 18) {
  console.log('Доступ запрещён');
} else if (age >= 18 && age < 65) {
  console.log('Добро пожаловать');
} else {
  console.log('Есть льготы');
}
```

- **Сумма чисел от 1 до N:**

```javascript
let sum = 0;
let n = 10;

for (let i = 1; i <= n; i++) {
  sum += i;
}

console.log('Сумма от 1 до 10:', sum);
```

- **Поиск значения в массиве:**

```javascript
let items = ['яблоко', 'банан', 'вишня'];
let target = 'банан';
let found = false;

for (let i = 0; i < items.length; i++) {
  if (items[i] === target) {
    found = true;
    break;
  }
}

console.log(found ? 'Найдено!' : 'Не найдено');
```

---

## 4. Работа с DOM

### 4.1. Поиск элементов

Чтобы взаимодействовать с DOM, сначала нужно получить ссылку на нужный элемент. Для этого используются методы поиска.

> **DOM (Document Object Model)** — это программный интерфейс для HTML-документов, который представляет структуру документа в виде дерева объектов.

**1. `document.getElementById(id)`**

Находит первый элемент по заданному id.

**HTML:**
```html
<p id="intro">Добро пожаловать!</p>
```

**JavaScript:**
```javascript
let paragraph = document.getElementById('intro');
console.log(paragraph.textContent); // Добро пожаловать!
```

Работает только с id. Быстрый и удобный способ получить один уникальный элемент.

**2. `document.querySelector(selector)`**

Находит первый элемент, соответствующий CSS-селектору.

**HTML:**
```html
<p class="text">Текст 1</p>
<p class="text">Текст 2</p>
```

**JavaScript:**
```javascript
let firstText = document.querySelector('.text');
console.log(firstText.textContent); // Текст 1
```

Можно использовать любые CSS-селекторы: `.class`, `#id`, `div > p`, `ul li:first-child` и т. д.

**3. `document.querySelectorAll(selector)`**

Находит все элементы, соответствующие CSS-селектору. Возвращает NodeList (псевдомассив).

**HTML:**
```html
<ul>
  <li>Один</li>
  <li>Два</li>
  <li>Три</li>
</ul>
```

**JavaScript:**
```javascript
let items = document.querySelectorAll('li');

items.forEach(function(item) {
  console.log(item.textContent);
});
```

Это удобно для обработки нескольких элементов сразу.

**Кратко:**
- `getElementById` — быстро, но только для id;
- `querySelector` — универсальный, когда нужен один элемент;
- `querySelectorAll` — когда нужно получить все подходящие элементы.

---

### 4.2. Изменение содержимого и атрибутов

После того как мы нашли элемент, мы можем изменить его текст, HTML-разметку или атрибуты. Рассмотрим основные способы.

> **Изменение содержимого** — это модификация текста, HTML-разметки или атрибутов элементов DOM.

**1. `element.textContent`**

Позволяет прочитать или задать только текстовое содержимое элемента.

**HTML:**
```html
<p id="greeting">Привет!</p>
```

**JavaScript:**
```javascript
let p = document.getElementById('greeting');
p.textContent = 'Здравствуйте!';
```

Безопасный способ изменить текст без внедрения HTML-кода.

**2. `element.innerHTML`**

Позволяет прочитать или задать внутреннюю HTML-разметку элемента.

**HTML:**
```html
<div id="container"></div>
```

**JavaScript:**
```javascript
let box = document.getElementById('container');
box.innerHTML = '<strong>Это жирный текст</strong>';
```

Используется, когда нужно вставить HTML-теги. Осторожно с внешним вводом — возможны XSS-уязвимости.

**3. `element.setAttribute(name, value)`**

Устанавливает значение любого атрибута элемента.

**HTML:**
```html
<img id="logo" src="logo.png" />
```

**JavaScript:**
```javascript
let img = document.getElementById('logo');
img.setAttribute('alt', 'Логотип компании');
img.setAttribute('src', 'new-logo.png');
```

Можно изменить любые стандартные HTML-атрибуты: `src`, `alt`, `href`, `title`, `value`, `id`, и т.д.

---

### 4.3. Изменение стилей и классов

После выбора элемента в DOM можно управлять его внешним видом: напрямую изменять стили или добавлять/удалять CSS-классы.

> **Управление стилями** — это изменение внешнего вида элементов через прямое задание стилей или управление CSS-классами.

**1. `element.style`**

Позволяет задать инлайновые стили напрямую из JavaScript.

**HTML:**
```html
<div id="box">Пример</div>
```

**JavaScript:**
```javascript
let box = document.getElementById('box');
box.style.color = 'white';
box.style.backgroundColor = 'blue';
box.style.padding = '10px';
```

Имена CSS-свойств пишутся в camelCase: `background-color` → `backgroundColor`.

Минус: переопределяет внешние стили, может мешать каскадности.

**2. `element.classList`**

Даёт доступ к списку классов элемента и предоставляет удобные методы управления ими.

**HTML:**
```html
<div id="alert" class="message">Сообщение</div>
```

**JavaScript:**
```javascript
let alertBox = document.getElementById('alert');

// Добавить класс
alertBox.classList.add('error');

// Удалить класс
alertBox.classList.remove('message');

// Переключить (если есть — уберёт, если нет — добавит)
alertBox.classList.toggle('hidden');

// Проверить наличие класса
if (alertBox.classList.contains('error')) {
  console.log('Ошибка отображается');
}
```

`classList` предпочтительнее, чем прямое изменение `className`, потому что не затирает другие классы.

**Когда что использовать:**
- Используй `.style`, если нужно экстренно задать конкретный стиль.
- Используй `.classList`, если работаешь с готовыми классами из CSS — это гибче и чище.

---

## 5. Обработка событий

События позволяют реагировать на действия пользователя: клики, ввод текста, отправку формы и многое другое. Для этого в JavaScript применяются обработчики событий.

> **События** — это действия или происшествия, которые происходят в браузере, на которые можно реагировать с помощью JavaScript.

---

### 5.1. Подключение обработчика: addEventListener

Метод `addEventListener()` — основной способ "подписаться" на событие.

> **addEventListener** — это метод, который позволяет назначить функцию-обработчик для определённого события элемента.

**Синтаксис:**
```javascript
element.addEventListener('тип_события', функция);
```

**Пример:**

**HTML:**
```html
<button id="btn">Нажми меня</button>
```

**JavaScript:**
```javascript
let button = document.getElementById('btn');

button.addEventListener('click', function () {
  alert('Кнопка нажата!');
});
```

---

### 5.2. Типы событий: click, input, change, submit

Основные события, часто используемые в интерфейсах:

**1. `click`** — срабатывает при клике:
```javascript
button.addEventListener('click', () => console.log('Клик!'));
```

**2. `input`** — срабатывает на каждый ввод в `<input>` или `<textarea>`:
```javascript
input.addEventListener('input', (e) => console.log(e.target.value));
```

**3. `change`** — срабатывает при изменении и потере фокуса, полезно для `<select>`, чекбоксов, радио:
```javascript
select.addEventListener('change', (e) => console.log('Выбрано:', e.target.value));
```

**4. `submit`** — отправка формы. Обязательно предотвращаем перезагрузку:
```javascript
form.addEventListener('submit', function (e) {
  e.preventDefault();
  console.log('Форма отправлена');
});
```

---

### 5.3. Коллбэк-функции и доступ к event

Обработчик — это функция, вызываемая при наступлении события. Ей автоматически передаётся объект события (`event` или `e`), содержащий информацию: целевой элемент, координаты клика, нажатые клавиши и пр.

> **Коллбэк-функция** — это функция, передаваемая в качестве аргумента другой функции и вызываемая при наступлении определённого события.

**Пример:**
```javascript
button.addEventListener('click', function (event) {
  console.log('Цель:', event.target);
  console.log('Тип события:', event.type);
});
```

Также можно использовать именованные функции:
```javascript
function handleClick(e) {
  console.log('Вы кликнули по кнопке:', e.target.textContent);
}

button.addEventListener('click', handleClick);
```

Коллбэк можно использовать повторно, удобно для читаемости и переиспользования.

---

## 6. Работа с консолью и отладка

Во время написания JavaScript важно понимать, как отслеживать поведение кода и находить ошибки. Браузеры предоставляют для этого мощные встроенные инструменты: консоль и отладчик.

> **Отладка** — это процесс поиска и исправления ошибок в программном коде с использованием специальных инструментов.

Работа с консолью позволяет:
- Понимать, какие значения получают переменные;
- Проверять, вызываются ли функции;
- Получать ошибки и предупреждения в реальном времени.

---

### 6.1. console.log, console.error, console.warn

Объект `console` включает несколько методов для вывода информации:

> **Console API** — это набор методов для вывода информации в консоль браузера, используемой для отладки и мониторинга.

**1. `console.log()`** — для обычного вывода данных (текст, переменные, объекты):
```javascript
console.log('Возраст:', age);
```

**2. `console.error()`** — выделяет ошибку красным в консоли:
```javascript
console.error('Ошибка при загрузке данных');
```

**3. `console.warn()`** — показывает предупреждение (жёлтый треугольник):
```javascript
console.warn('Это устаревший способ вызова функции');
```

**Также полезно:**

- **`console.table()`** — для вывода таблиц:
```javascript
console.table([{ имя: 'Аня' }, { имя: 'Иван' }]);
```

- **`console.clear()`** — очищает консоль (полезно при множественных логах).