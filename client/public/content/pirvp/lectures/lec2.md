# Лекция №2. Работа браузера и семантический HTML

---

## 1. Отображение страницы в браузере

Когда мы открываем веб-страницу в браузере, на первый взгляд кажется, что всё просто — ввёл адрес, нажал Enter, и страница загрузилась.  
Но на самом деле процесс отображения страницы очень сложный и многоступенчатый. Чтобы браузер мог показать красивую и интерактивную страницу, он должен выполнить несколько ключевых шагов:

- Прочитать и понять HTML-код, из которого состоит страница.  
- Обработать CSS — стили, которые задают внешний вид элементов.  
- Объединить эту информацию в структуру, понятную для отрисовки.  
- Посчитать, где и как располагаются элементы на экране.  
- Нарисовать пиксели на экране.  
- Если страница меняется, обновить отображение эффективно, без лишних затрат.  

---

### 1.1. Парсинг HTML и построение DOM

Первым и самым важным этапом в работе браузера является разбор HTML-документа — процесс, который называется **парсингом** (от англ. parse — разбирать).

Когда браузер получает HTML-код страницы, он начинает читать его последовательно, символ за символом.  

Во время парсинга браузер преобразует HTML-теги и текст в специальную структуру данных — **DOM (Document Object Model)**, которая представляет собой дерево объектов.

**Что такое DOM?**

> **DOM** — это объектная модель документа, которая отражает структуру HTML в виде дерева. Каждый HTML-элемент становится отдельным узлом (**node**) в этом дереве.  

**Например:** если у нас есть тег `<p>`, в DOM будет создан узел с типом «элемент» и содержимым — текстом внутри этого тега.

DOM важен, потому что он позволяет браузеру и скриптам (например, JavaScript) взаимодействовать с содержимым страницы — изменять, добавлять или удалять элементы динамически.

**Как происходит парсинг?**

Парсер читает HTML сверху вниз, создавая узлы DOM по мере встречи с тегами.  

- Если встречается открывающий тег, создаётся новый элемент, который становится дочерним по отношению к предыдущему.  
- Когда парсер встречает закрывающий тег, он возвращается на уровень выше.  

Если HTML содержит ошибки (например, забытый закрывающий тег), браузер старается исправить их автоматически, чтобы построить корректный DOM.

**Пример:**

```html
<html>
  <body>
    <h1>Заголовок страницы</h1>
    <p>Это пример абзаца.</p>
  </body>
</html>
```


```bash
html
└── body
    ├── h1 ("Заголовок страницы")
    └── p ("Это пример абзаца.")
```

---

### 1.2. Обработка CSS и построение CSSOM

После того как браузер завершил парсинг HTML и построил DOM, следующим шагом он обрабатывает CSS — каскадные таблицы стилей, которые определяют внешний вид элементов страницы: цвета, шрифты, отступы, размеры и многое другое.

**Что такое CSSOM?**

Подобно DOM, который представляет структуру HTML-документа, браузер создаёт структуру данных для CSS — **CSSOM (CSS Object Model)**. 

> **CSSOM** — это дерево, которое описывает все стили, применённые к элементам страницы.

**Как происходит построение CSSOM?**

- Браузер загружает все CSS-файлы и встроенные стили (`<style>` в HTML).  
- Парсит CSS-код, разбирает правила и селекторы.  
- Для каждого правила создаёт объекты с информацией о том, к каким элементам применять стили и какие свойства заданы.  
- Собирает все стили в единую структуру — CSSOM.

**Важность CSSOM:**

CSSOM необходим для того, чтобы браузер мог правильно сопоставить стили с элементами DOM. После этого можно определить, как будет выглядеть каждый элемент.

**Взаимодействие DOM и CSSOM:**

> DOM и CSSOM — это две разные структуры, которые браузер объединяет в следующем шаге — создании **Render Tree (дерева отрисовки)**, чтобы понять, что и как рисовать на экране.

**Пример**

```html
<p class="text">Пример текста</p>
```

```css
.text {
  color: red;
  font-size: 18px;
}
```

В CSSOM создаётся объект, который описывает эти стили, и браузер знает, что элемент с классом `text` должен быть красного цвета и с размером шрифта 18 пикселей.

**Особенности:**

- CSSOM включает в себя все стили: внешние, внутренние, а также стили, добавленные динамически через JavaScript.
- Если стили изменяются, CSSOM нужно обновлять, что может повлиять на производительность.

---

### 1.3. Создание Render Tree

После того, как браузер построил DOM и CSSOM, следующим шагом является объединение этих данных в структуру, которая определяет, что именно и как будет отображено на экране. Эта структура называется **Render Tree** — дерево отрисовки.

**Что такое Render Tree?**  

Render Tree содержит визуальные элементы страницы, которые нужно показать пользователю, с учётом их стилей, размеров и расположения.  
В отличие от DOM, Render Tree содержит только те узлы, которые видимы (например, элементы с `display: none` в него не попадают).

**Как строится Render Tree?**

1. Браузер проходит по DOM и для каждого элемента находит соответствующие стили из CSSOM.  
2. Создаёт узлы Render Tree, в которых содержится информация о том, как рисовать каждый элемент — его размеры, цвет, положение и так далее.  
3. Пропускает невидимые элементы (например, с `display: none`), потому что их рисовать не нужно.

**Зачем нужен Render Tree?**  

Render Tree — это промежуточное представление страницы, которое оптимизировано именно для отрисовки. По нему браузер будет считать расположение элементов и рисовать их.

---

### 1.4. Этапы отрисовки: Layout → Paint → Composite

Когда Render Tree готов, браузер приступает к отрисовке страницы — процессу перевода данных в видимое изображение на экране. Этот процесс состоит из нескольких последовательных этапов:

**1. Layout (расчёт расположения):**

На этом этапе браузер рассчитывает точное расположение и размеры каждого узла Render Tree — где именно на странице будет находиться каждый элемент, его ширина, высота, отступы и так далее.  

Этот этап ещё называют **reflow** (перерасчёт), потому что он часто происходит при изменении структуры или стилей страницы.

**2. Paint (рисование):**

После того как браузер знает размеры и позицию элементов, он переходит к этапу **paint** — рисованию пикселей на слоях.  

Здесь браузер наносит цвета, текст, тени, границы и другие визуальные эффекты.

**3. Composite (сборка слоёв):**

Современные браузеры оптимизируют процесс, разбивая страницу на отдельные слои.  

На этапе **composite** происходит сборка этих слоёв в одно изображение, которое выводится на экран.  

Разделение на слои позволяет улучшить производительность — если изменился только один слой, браузер может перерисовать только его, не трогая остальные.

[![RENDERING PATH](https://i.postimg.cc/5tLxbcqy/image.png)](https://postimg.cc/Ty28J4sv)

---

### 1.5. Reflow и Repaint

В процессе отрисовки страницы браузер часто сталкивается с необходимостью обновить отображение, если что-то изменилось. Эти обновления делятся на два типа:

**Reflow (перерасчёт):**

**Reflow** — это процесс перерасчёта расположения и размеров элементов на странице. Он запускается, когда меняется структура документа или свойства, влияющие на геометрию, например:
- Изменение размеров окна браузера (ресайз).  
- Добавление, удаление или изменение элементов DOM.  
- Изменение CSS-свойств, таких как `width`, `height`, `margin`, `padding`, `font-size`.  
- Изменение контента, которое влияет на размер элементов (например, изменение текста).  

Reflow — дорогостоящая операция по производительности, так как браузеру нужно пересчитать позиции всех связанных элементов.

**Repaint (перерисовка)**

**Repaint** — это процесс перерисовки пикселей, когда изменяются визуальные свойства, но без изменения геометрии.  
Например:
- Изменение цвета (`color`, `background-color`).  
- Изменение тени (`box-shadow`).  
- Изменение видимости (`visibility: hidden`).  

Repaint обычно менее затратен, чем reflow, но всё равно влияет на производительность.

---

## 2. Семантическая структура HTML

Создание качественного веб-контента — это не только красиво оформленный внешний вид, но и правильная структура HTML-документа.  
Семантический HTML помогает сделать код более понятным, улучшить SEO и обеспечить доступность для пользователей с особыми потребностями.

---

### 2.1. Семантика HTML

Семантика — это смысловое наполнение элементов HTML. Использование семантических тегов помогает браузерам, поисковым системам и вспомогательным технологиям правильно интерпретировать структуру и содержание страницы.

**Зачем нужна семантика:**

- **Повышение читаемости кода:** Другие разработчики легче понимают структуру и назначение каждого элемента.  
- **Улучшение SEO:** Поисковые роботы лучше индексируют содержимое, что повышает рейтинг страницы.  
- **Доступность (a11y):** Специальные технологии (например, скринридеры) корректно озвучивают содержимое для людей с нарушениями зрения.

---

### 2.2. Основные теги документа и контейнеры

HTML-документ строится вокруг нескольких ключевых тегов, которые задают его структуру и содержат различные блоки информации.

**Каркас HTML-документа:**

- `<html>` — корневой элемент страницы, содержит весь контент документа.  
- `<head>` — секция для метаданных, скриптов, стилей и информации, которая не отображается напрямую на странице.  
- `<body>` — основное тело документа, где располагается весь видимый контент.

**Универсальные контейнеры:**

- `<div>` — блочный контейнер, не несущий семантического значения. Используется для группировки элементов и стилизации.  
- `<span>` — строчный контейнер, также без семантической нагрузки, часто применяется для выделения части текста.

**Пример:**

```html
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Пример документа</title>
</head>
<body>
  <div class="container">
    <span>Текст внутри span</span>
  </div>
</body>
</html>
```

---

### 2.3. Структурные элементы страницы

Семантические теги позволяют не просто группировать содержимое, но и показывать его роль на странице. Это облегчает понимание структуры как человеку, так и машинам.

**Основные структурные теги:**

- `<header>` — верхняя часть страницы или раздела, обычно содержит заголовок, логотип, навигацию.  
- `<nav>` — блок навигационных ссылок по сайту или разделу.  
- `<main>` — основное содержимое страницы, уникальное и главное. На странице должен быть только один `<main>`.  
- `<section>` — тематический раздел страницы, может содержать заголовок и несколько элементов.  
- `<article>` — самостоятельный контент, например, статья, блог-пост или новость. Может существовать отдельно от остального контента.  
- `<aside>` — боковая панель, дополнительная информация, связанная с основным содержимым (реклама, ссылки, цитаты).  
- `<footer>` — нижняя часть страницы или раздела, содержит авторские права, контакты, ссылки на политику конфиденциальности.

**Пример использования:**

```html
<body>
  <header>
    <h1>Название сайта</h1>
    <nav>
      <ul>
        <li><a href="#main">Главная</a></li>
        <li><a href="#articles">Статьи</a></li>
      </ul>
    </nav>
  </header>
  
  <main id="main">
    <section>
      <h2>Раздел 1</h2>
      <article>
        <h3>Статья 1</h3>
        <p>Текст статьи...</p>
      </article>
    </section>
    
    <aside>
      <h4>Дополнительно</h4>
      <p>Полезная информация и ссылки.</p>
    </aside>
  </main>
  
  <footer>
    <p>© 2025 Все права защищены.</p>
  </footer>
</body>
```

---

### 2.4. Заголовки и текст

Заголовки и текстовые элементы — основа контента страницы. Правильное использование заголовков помогает структурировать информацию и улучшает восприятие.

**Заголовки: `<h1>` — `<h6>`**

- Обозначают уровни заголовков от самого важного (`<h1>`) до наименее важного (`<h6>`).  
- На странице должен быть только один `<h1>`, который обозначает основной заголовок.  
- Заголовки строят иерархию документа, помогают пользователям и поисковым системам понимать структуру.

**Текстовые элементы**

- `<p>` — параграф, основной блок текста.  
- `<strong>` — выделение важного текста, обычно жирным шрифтом; семантически обозначает усиление значимости.  
- `<em>` — выделение текста курсивом, обозначает акцент или интонацию.  
- `<blockquote>` — цитата из другого источника, обычно с отступом и курсивом.  
- `<code>` — фрагмент кода или программного текста, моноширинный шрифт.

**Пример:**

```html
<h1>Основной заголовок страницы</h1>

<p>Это первый параграф с обычным текстом.</p>

<p><strong>Важное выделение</strong> и <em>акцент</em> в тексте.</p>

<blockquote>
  "Это цитата из другого источника."
</blockquote>

<p>Пример кода: <code>console.log('Hello, world!');</code></p>
```

---

### 2.5. Списки

Списки позволяют структурировать информацию в удобном и понятном виде. В HTML есть несколько типов списков для разных целей.

**Ненумерованные списки — `<ul>`**

- Используются для перечисления элементов без определённого порядка.  
- Каждый элемент списка помещается в тег `<li>`.

**Пример:**

```html
<ul>
  <li>Первый пункт</li>
  <li>Второй пункт</li>
  <li>Третий пункт</li>
</ul>
```

**Нумерованные списки — `<ol>`**

- Для упорядоченных списков с порядковыми номерами.  
- Тоже содержат элементы `<li>`.

**Пример:**

```html
<ol>
  <li>Первый шаг</li>
  <li>Второй шаг</li>
  <li>Третий шаг</li>
</ol>
```

**Описательные списки — `<dl>`, `<dt>`, `<dd>`**

- Используются для пар "термин — описание".  
- `<dl>` — контейнер списка описаний.  
- `<dt>` — термин (название).  
- `<dd>` — описание термина.

**Пример:**

```html
<dl>
  <dt>HTML</dt>
  <dd>Язык гипертекстовой разметки для создания страниц.</dd>

  <dt>CSS</dt>
  <dd>Таблицы каскадных стилей для оформления страниц.</dd>
</dl>
```

---

### 2.6. Ссылки и изображения

Ссылки и изображения — важные элементы веб-страницы, обеспечивающие навигацию и визуальное восприятие.

**Ссылки — `<a>`**

- Используются для перехода на другие страницы, документы или участки текущей страницы.  
- Атрибут `href` указывает адрес ссылки.  
- Текст внутри тега `<a>` — кликабельная часть.  
- Для внутренних ссылок на определённый раздел страницы используется `href="#id"`.

**Пример:**

```html
<a href="https://example.com">Перейти на Example.com</a>
```

**Изображения — `<img>`**

- Вставляют изображения на страницу.  
- Обязательный атрибут `src` — путь к изображению.  
- Обязателен атрибут `alt` — текстовое описание для доступности и SEO.

**Пример:**

```html
<img src="logo.png" alt="Логотип сайта">
```

** Семантическая обёртка для изображений — `<figure>` и `<figcaption>`**

- `<figure>` группирует изображение с подписью.  
- `<figcaption>` — подпись к изображению.  

**Пример:**

```html
<figure>
  <img src="photo.jpg" alt="Природа">
  <figcaption>Фото природы, сделанное в горах</figcaption>
</figure>
```

---

### 2.7. Медиа-элементы

HTML поддерживает встроенные средства для воспроизведения мультимедийного контента — аудио и видео.

**Видео — `<video>`**

Позволяет вставлять видеофайлы на страницу.  

**Атрибуты:**
- `controls` — отображает панель управления (воспроизведение, пауза и т.д.).  
- `autoplay` — автоматический запуск видео.  
- `loop` — зацикливание видео.  
- `muted` — видео без звука.  
- Внутри `<video>` можно добавлять несколько `<source>`, чтобы указать разные форматы видео для совместимости.

**Пример:**

```html
<video controls width="640" height="360">
  <source src="movie.mp4" type="video/mp4">
  <source src="movie.webm" type="video/webm">
  Ваш браузер не поддерживает видео.
</video>
```
**Аудио — `<audio>`**

Для вставки аудиозаписей.  
Атрибуты схожи с `<video>`.

**Пример:**

```html
<audio controls>
  <source src="audio.mp3" type="audio/mpeg">
  <source src="audio.ogg" type="audio/ogg">
  Ваш браузер не поддерживает аудио.
</audio>
```
**Дополнительно — `<track>`**

Добавляет субтитры, описания и прочие текстовые дорожки к видео и аудио.  
**Атрибуты:**
- `kind` — тип дорожки (`captions`, `subtitles`, `descriptions`).  
- `src` — файл с текстом субтитров.  
- `srclang` — язык дорожки.  
- `label` — название дорожки.  

**Пример:**

```html
<video controls>
  <source src="movie.mp4" type="video/mp4">
  <track kind="subtitles" src="subs_en.vtt" srclang="en" label="English">
</video>
```

---

### 2.8. Таблицы

Таблицы используются для представления табличных данных — например, расписаний, прайс-листов, статистики.  
HTML предоставляет набор тегов для создания структурированной и читаемой таблицы.

**Основные теги таблицы:**

- `<table>` — контейнер таблицы.  
- `<tr>` (table row) — строка таблицы.  
- `<th>` (table header) — ячейка заголовка (обычно жирная и по центру).  
- `<td>` (table data) — обычная ячейка таблицы.  
- `<thead>` — заголовок таблицы (группа строк с заголовками).  
- `<tbody>` — основное содержимое таблицы.  
- `<tfoot>` — подвал таблицы (например, итоги).  

**Пример таблицы:**

```html
<table border='1'>
  <thead>
    <tr>
      <th>Имя</th>
      <th>Возраст</th>
      <th>Город</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Анна</td>
      <td>25</td>
      <td>Москва</td>
    </tr>
    <tr>
      <td>Иван</td>
      <td>30</td>
      <td>Санкт-Петербург</td>
    </tr>
  </tbody>
  <tfoot>
    <tr>
      <td colspan="3">Итог: 2 пользователя</td>
    </tr>
  </tfoot>
</table>
```
**Дополнительные атрибуты:**
- `colspan` — объединение ячеек по горизонтали.
- `rowspan` — объединение по вертикали.

---

### 2.9. Формы и элементы ввода

Формы — ключевой инструмент для взаимодействия пользователя с сайтом. С их помощью можно отправлять данные на сервер: логины, комментарии, заявки и т.д.

**Основной тег формы — `<form>`**

- Обёртка для всех элементов ввода.  
- Атрибуты:
  - `action` — адрес, на который отправляются данные.  
  - `method` — способ отправки (`get` или `post`).  

**Пример формы:**

```html
<form action="/submit" method="post">
  <!-- поля формы -->
</form>
```

**Элементы ввода: `<input>`**

Многофункциональный тег. Основное поведение зависит от атрибута `type`:

- `text` — однострочное текстовое поле  
- `email` — ввод email  
- `password` — скрытый ввод  
- `checkbox`, `radio` — флажки и переключатели  
- `file` — выбор файла  
- `submit`, `reset`, `button` — кнопки  

**Пример:**

```html
<input type="text" name="username" placeholder="Имя пользователя" required>
```

**`<label>`**

Текстовая подпись к полю. Атрибут `for` должен совпадать с `id` поля.

**Пример:**

```html
<label for="email">Email:</label>
<input type="email" id="email" name="email">
```

**`<textarea>`**

Многострочное текстовое поле для ввода данных пользователем.

**Пример:**

```html
<textarea name="message" rows="5" cols="30" placeholder="Введите сообщение..."></textarea>
```

**`<select>` и `<option>`**

Выпадающий список для выбора одного значения из списка.

**Пример:**

```html
<select name="city">
  <option value="msk">Москва</option>
  <option value="spb">Санкт-Петербург</option>
</select>
```

**`<button>`**

Кнопка для отправки формы или выполнения действий. По умолчанию имеет тип `submit`.

**Пример:**

```html
<button type="submit">Отправить</button>
```

**Часто используемые атрибуты элементов формы:**

- `type` — тип поля (`text`, `password`, `submit` и др.)
- `placeholder` — текст-подсказка внутри поля
- `required` — делает поле обязательным
- `checked` — по умолчанию отмеченный чекбокс или радиокнопка
- `value` — значение поля
- `name` — имя, по которому данные будут переданы
- `for` — связывает `<label>` с полем по `id`

---

### 2.10. Проверка HTML на валидность

Даже при внимательной работе в HTML легко допустить ошибки: забытые закрывающие теги, неверная вложенность, устаревшие атрибуты. Такие ошибки могут повлиять на отображение страницы, её доступность и индексацию в поисковых системах.

**Зачем проверять HTML?**
- Гарантия корректной структуры документа.
- Улучшение совместимости с браузерами.
- Повышение доступности и SEO.
- Помощь в обучении — валидатор подсказывает, какие ошибки вы допустили.

**Инструмент: W3C Validator**
Официальный валидатор от World Wide Web Consortium:  
[https://validator.w3.org](https://validator.w3.org)

**Типичные ошибки:**
- Пропущенный закрывающий тег.
- Вложенные элементы в неправильном порядке.
- Неподдерживаемые или устаревшие атрибуты.
- Отсутствие обязательных атрибутов (`alt`, `lang` и т.д.).

---

## 3. Атрибуты и доступность

Современные сайты должны быть не только красивыми, но и доступными.  
Это означает, что ими должны уметь пользоваться все: люди с нарушениями зрения, слуха, моторики, когнитивными особенностями. И HTML предоставляет для этого необходимые средства.

---

### 3.1. Стандартные атрибуты

Ниже — часто используемые универсальные атрибуты, которые помогают улучшить читаемость, навигацию и доступность:

- `id` — уникальный идентификатор элемента. Используется для привязки к `<label>`, якорям, скриптам.
- `class` — назначение классов для стилизации и JS.
- `alt` — текстовое описание изображений (обязательно для `<img>`).
- `title` — всплывающая подсказка при наведении.
- `lang` — язык содержимого документа или элемента (`<html lang="ru">`).
- `tabindex` — задаёт порядок фокусировки клавишей Tab (`0`, `-1`, `1`, ...).

**Пример:**
```html
<img src="cat.jpg" alt="Пушистый серый кот" title="Нажмите для увеличения">
```

---

### 3.2. ARIA-атрибуты

ARIA (Accessible Rich Internet Applications) — это набор специальных атрибутов, помогающих вспомогательным технологиям (например, скринридерам) лучше понимать интерфейс и взаимодействовать с ним.

**Часто используются:**

- `aria-label` — задаёт название для элемента, которого нет в визуальном тексте.
- `aria-hidden="true"` — скрывает элемент от вспомогательных технологий.
- `aria-describedby` — указывает ID элемента, содержащего описание.

**Пример:**
```html
<button aria-label="Закрыть окно">
  <svg><!-- иконка закрытия --></svg>
</button>
```

---

### 3.3. Связь семантики и доступности

Правильное использование семантических HTML-тегов не только делает код чище и понятнее, но и повышает доступность сайта. Скринридеры, браузеры и поисковые системы понимают назначение элементов благодаря их семантической роли. Это особенно важно для людей с нарушениями зрения и моторики, которые взаимодействуют с сайтом с помощью клавиатуры или голосовых технологий.

**Почему семантика важна для доступности:**
- Скринридеры могут озвучивать элементы, зная их назначение. Например, “кнопка”, “навигация”, “основной контент”.
- Навигация с клавиатуры становится быстрее и логичнее, когда правильно используются `<nav>`, `<main>`, `<header>` и другие теги.
- Вспомогательные технологии могут пропустить повторяющийся контент (например, шапку сайта) и перейти сразу к нужному разделу.

**Примеры:**
- `<nav>` — объявляет навигационную область. Скринридеры могут сообщать пользователю: “Навигация началась” и “Навигация закончилась”.
- `<main>` — основной контент страницы. Позволяет быстро перейти к главной информации, минуя повторяющиеся блоки (меню, сайдбар).
- `<header>` — сообщает, что блок является заголовком страницы или раздела.
- `<footer>` — указывает на нижнюю часть страницы, часто содержит контактную информацию и ссылки.
- `<button>` — сообщает скринридеру, что это интерактивная кнопка (в отличие от `<div>` или `<span>` с JavaScript).

> Если вместо `<button>` используется `<div>` с `onclick`, пользователь скринридера не узнает, что это элемент управления.
